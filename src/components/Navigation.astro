---
export interface Props {
	currentPage?: string;
}

const { currentPage } = Astro.props;
---

<nav class="fixed top-0 w-full bg-transparent backdrop-blur-md z-50 transition-all duration-300" id="navbar">
	<div class="max-w-7xl mx-auto px-6">
		<div class="flex items-center justify-between h-16">
			<a href="/" class="font-bold text-xl text-white drop-shadow-lg">
				<span class="text-blue-300">Shoreline</span> Web Solutions
			</a>
			
			<div class="hidden md:flex space-x-8 items-center">
				<a href="/" class={`font-medium transition-colors drop-shadow-sm ${currentPage === 'home' ? 'text-blue-300' : 'text-white hover:text-blue-300'}`}>Home</a>
				<a href="/about" class={`font-medium transition-colors drop-shadow-sm ${currentPage === 'about' ? 'text-blue-300' : 'text-white hover:text-blue-300'}`}>About</a>
				
				<!-- Services Dropdown -->
				<div class="relative group" id="services-dropdown">
					<button 
						class={`font-medium transition-colors drop-shadow-sm flex items-center gap-1 ${currentPage === 'services' ? 'text-blue-300' : 'text-white hover:text-blue-300'}`}
						aria-label="Services menu"
						aria-expanded="false"
						aria-haspopup="true"
						id="desktop-services-button"
					>
						Services
						<svg class="w-4 h-4 transition-transform group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
						</svg>
					</button>
					<div class="absolute top-full left-0 mt-2 w-64 bg-white/95 backdrop-blur-md rounded-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 z-50 border border-white/20">
						<div class="py-2">
							<a href="/services" class="block px-4 py-2 text-slate-700 hover:bg-blue-50 hover:text-blue-600 transition-colors">All Services</a>
							
							<!-- Custom AI Solutions with submenu -->
							<div class="relative ai-solutions-submenu">
								<a href="/custom-ai-solutions" class="block px-4 py-2 text-slate-700 hover:bg-blue-50 hover:text-blue-600 transition-colors flex items-center justify-between">
									<span>Custom AI Solutions</span>
									<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
										<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
									</svg>
								</a>
								<div class="absolute left-full top-0 ml-2 w-56 bg-white/95 backdrop-blur-md rounded-lg shadow-xl opacity-0 invisible ai-solutions-submenu-content transition-all duration-200 border border-white/20">
									<div class="py-2">
										<a href="/ai-review-response" class="block px-4 py-2 text-slate-700 hover:bg-blue-50 hover:text-blue-600 transition-colors">AI Review Response</a>
										<a href="/services/ai-chat-assistant" class="block px-4 py-2 text-slate-700 hover:bg-blue-50 hover:text-blue-600 transition-colors">AI Chat Assistant</a>
									</div>
								</div>
							</div>
							
							<a href="/services/custom-web-development" class="block px-4 py-2 text-slate-700 hover:bg-blue-50 hover:text-blue-600 transition-colors">Custom Web Development</a>
							<a href="/services/ecommerce-solutions" class="block px-4 py-2 text-slate-700 hover:bg-blue-50 hover:text-blue-600 transition-colors">E-commerce Solutions</a>
							<a href="/services/seo-digital-marketing" class="block px-4 py-2 text-slate-700 hover:bg-blue-50 hover:text-blue-600 transition-colors">SEO & Digital Marketing</a>
						</div>
					</div>
				</div>
				
				<a href="/portfolio" class={`font-medium transition-colors drop-shadow-sm ${currentPage === 'portfolio' ? 'text-blue-300' : 'text-white hover:text-blue-300'}`}>Portfolio</a>
				<a href="/blog" class={`font-medium transition-colors drop-shadow-sm ${currentPage === 'blog' ? 'text-blue-300' : 'text-white hover:text-blue-300'}`}>Blog</a>
				<a href="/contact" class={`font-medium transition-colors drop-shadow-sm ${currentPage === 'contact' ? 'text-blue-300' : 'text-white hover:text-blue-300'}`}>Contact</a>
			</div>
			
			<!-- Mobile menu button -->
			<button 
				class="md:hidden p-2 text-white drop-shadow-sm" 
				id="mobile-menu-button"
				aria-label="Toggle navigation menu"
				aria-expanded="false"
				aria-controls="mobile-menu"
			>
				<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
				</svg>
			</button>
		</div>
		
		<!-- Mobile menu -->
		<div class="md:hidden hidden" id="mobile-menu">
			<div class="px-2 pt-2 pb-3 space-y-1 bg-transparent backdrop-blur-md border-t border-white/20 rounded-b-lg mx-2">
				<a href="/" class={`block px-3 py-2 rounded-md text-base font-medium transition-colors drop-shadow-sm ${currentPage === 'home' ? 'text-blue-300 bg-white/10' : 'text-white hover:text-blue-300 hover:bg-white/10'}`}>Home</a>
				<a href="/about" class={`block px-3 py-2 rounded-md text-base font-medium transition-colors drop-shadow-sm ${currentPage === 'about' ? 'text-blue-300 bg-white/10' : 'text-white hover:text-blue-300 hover:bg-white/10'}`}>About</a>
				
				<!-- Mobile Services Dropdown -->
				<div class="services-mobile-dropdown">
					<button 
						class={`w-full text-left px-3 py-2 rounded-md text-base font-medium transition-colors drop-shadow-sm flex items-center justify-between ${currentPage === 'services' ? 'text-blue-300 bg-white/10' : 'text-white hover:text-blue-300 hover:bg-white/10'}`} 
						id="mobile-services-button"
						aria-label="Toggle services menu"
						aria-expanded="false"
						aria-haspopup="true"
						aria-controls="mobile-services-menu"
					>
						<span>Services</span>
						<svg class="w-4 h-4 transition-transform" id="mobile-services-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
						</svg>
					</button>
					<div class="hidden pl-4 pt-1 space-y-1" id="mobile-services-menu" role="menu">
						<a href="/services" class="block px-3 py-2 rounded-md text-sm font-medium transition-colors drop-shadow-sm text-blue-200 hover:text-blue-300 hover:bg-white/10">All Services</a>
						
						<!-- Mobile Custom AI Solutions Submenu -->
						<div class="mobile-ai-solutions">
							<button 
								class="w-full text-left px-3 py-2 rounded-md text-sm font-medium transition-colors drop-shadow-sm text-blue-200 hover:text-blue-300 hover:bg-white/10 flex items-center justify-between"
								id="mobile-ai-solutions-button"
								aria-label="Toggle Custom AI Solutions menu"
								aria-expanded="false"
								aria-haspopup="true"
								aria-controls="mobile-ai-solutions-menu"
							>
								<span>Custom AI Solutions</span>
								<svg class="w-4 h-4 transition-transform" id="mobile-ai-solutions-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
								</svg>
							</button>
							<div class="hidden pl-4 pt-1 space-y-1" id="mobile-ai-solutions-menu" role="menu">
								<a href="/ai-review-response" class="block px-3 py-2 rounded-md text-sm font-medium transition-colors drop-shadow-sm text-blue-200 hover:text-blue-300 hover:bg-white/10">AI Review Response</a>
								<a href="/services/ai-chat-assistant" class="block px-3 py-2 rounded-md text-sm font-medium transition-colors drop-shadow-sm text-blue-200 hover:text-blue-300 hover:bg-white/10">AI Chat Assistant</a>
							</div>
						</div>
						
						<a href="/services/custom-web-development" class="block px-3 py-2 rounded-md text-sm font-medium transition-colors drop-shadow-sm text-blue-200 hover:text-blue-300 hover:bg-white/10">Custom Web Development</a>
						<a href="/services/ecommerce-solutions" class="block px-3 py-2 rounded-md text-sm font-medium transition-colors drop-shadow-sm text-blue-200 hover:text-blue-300 hover:bg-white/10">E-commerce Solutions</a>
						<a href="/services/seo-digital-marketing" class="block px-3 py-2 rounded-md text-sm font-medium transition-colors drop-shadow-sm text-blue-200 hover:text-blue-300 hover:bg-white/10">SEO & Digital Marketing</a>
					</div>
				</div>
				
				<a href="/portfolio" class={`block px-3 py-2 rounded-md text-base font-medium transition-colors drop-shadow-sm ${currentPage === 'portfolio' ? 'text-blue-300 bg-white/10' : 'text-white hover:text-blue-300 hover:bg-white/10'}`}>Portfolio</a>
				<a href="/blog" class={`block px-3 py-2 rounded-md text-base font-medium transition-colors drop-shadow-sm ${currentPage === 'blog' ? 'text-blue-300 bg-white/10' : 'text-white hover:text-blue-300 hover:bg-white/10'}`}>Blog</a>
				<a href="/contact" class={`block px-3 py-2 rounded-md text-base font-medium transition-colors drop-shadow-sm ${currentPage === 'contact' ? 'text-blue-300 bg-white/10' : 'text-white hover:text-blue-300 hover:bg-white/10'}`}>Contact</a>
			</div>
		</div>
	</div>
</nav>

<script>
	// Mobile menu toggle functionality and scroll effects
	function initNavigation() {
		const mobileMenuButton = document.getElementById('mobile-menu-button');
		const mobileMenu = document.getElementById('mobile-menu');
		const navbar = document.getElementById('navbar');
		const mobileServicesButton = document.getElementById('mobile-services-button');
		const mobileServicesMenu = document.getElementById('mobile-services-menu');
		const mobileServicesArrow = document.getElementById('mobile-services-arrow');
		
		// Mobile menu toggle
		if (mobileMenuButton && mobileMenu) {
			// Remove any existing event listeners to prevent duplicates
			mobileMenuButton.replaceWith(mobileMenuButton.cloneNode(true));
			const newMobileMenuButton = document.getElementById('mobile-menu-button');
			
			if (newMobileMenuButton) {
				newMobileMenuButton.addEventListener('click', function() {
					const isHidden = mobileMenu.classList.contains('hidden');
					mobileMenu.classList.toggle('hidden');
					newMobileMenuButton.setAttribute('aria-expanded', isHidden ? 'true' : 'false');
				});
			}
		}
		
		// Mobile services dropdown toggle
		if (mobileServicesButton && mobileServicesMenu && mobileServicesArrow) {
			// Remove any existing event listeners to prevent duplicates
			mobileServicesButton.replaceWith(mobileServicesButton.cloneNode(true));
			const newMobileServicesButton = document.getElementById('mobile-services-button');
			const newMobileServicesMenu = document.getElementById('mobile-services-menu');
			const newMobileServicesArrow = document.getElementById('mobile-services-arrow');
			
			if (newMobileServicesButton && newMobileServicesMenu && newMobileServicesArrow) {
				newMobileServicesButton.addEventListener('click', function(e) {
					e.preventDefault();
					const isHidden = newMobileServicesMenu.classList.contains('hidden');
					newMobileServicesMenu.classList.toggle('hidden');
					newMobileServicesArrow.classList.toggle('rotate-180');
					newMobileServicesButton.setAttribute('aria-expanded', isHidden ? 'true' : 'false');
				});
			}
		}
		
		// Mobile AI Solutions submenu toggle
		const mobileAISolutionsButton = document.getElementById('mobile-ai-solutions-button');
		const mobileAISolutionsMenu = document.getElementById('mobile-ai-solutions-menu');
		const mobileAISolutionsArrow = document.getElementById('mobile-ai-solutions-arrow');
		
		if (mobileAISolutionsButton && mobileAISolutionsMenu && mobileAISolutionsArrow) {
			// Remove any existing event listeners to prevent duplicates
			mobileAISolutionsButton.replaceWith(mobileAISolutionsButton.cloneNode(true));
			const newMobileAISolutionsButton = document.getElementById('mobile-ai-solutions-button');
			const newMobileAISolutionsMenu = document.getElementById('mobile-ai-solutions-menu');
			const newMobileAISolutionsArrow = document.getElementById('mobile-ai-solutions-arrow');
			
			if (newMobileAISolutionsButton && newMobileAISolutionsMenu && newMobileAISolutionsArrow) {
				newMobileAISolutionsButton.addEventListener('click', function(e) {
					e.preventDefault();
					const isHidden = newMobileAISolutionsMenu.classList.contains('hidden');
					newMobileAISolutionsMenu.classList.toggle('hidden');
					newMobileAISolutionsArrow.classList.toggle('rotate-180');
					newMobileAISolutionsButton.setAttribute('aria-expanded', isHidden ? 'true' : 'false');
				});
			}
		}
		
		// Desktop services dropdown - update aria-expanded on hover
		const desktopServicesButton = document.getElementById('desktop-services-button');
		const desktopServicesDropdown = document.getElementById('services-dropdown');
		if (desktopServicesButton && desktopServicesDropdown) {
			desktopServicesDropdown.addEventListener('mouseenter', function() {
				desktopServicesButton.setAttribute('aria-expanded', 'true');
			});
			desktopServicesDropdown.addEventListener('mouseleave', function() {
				desktopServicesButton.setAttribute('aria-expanded', 'false');
			});
		}
		
		// Scroll effect for navbar
		if (navbar) {
			// Remove existing scroll listener to prevent duplicates
			window.removeEventListener('scroll', handleNavbarScroll);
			window.addEventListener('scroll', handleNavbarScroll);
		}
	}
	
	function handleNavbarScroll() {
		const navbar = document.getElementById('navbar');
		if (navbar) {
			if (window.scrollY > 50) {
				navbar.classList.add('bg-black/20');
				navbar.classList.remove('bg-transparent');
			} else {
				navbar.classList.add('bg-transparent');
				navbar.classList.remove('bg-black/20');
			}
		}
	}
	
	// Initialize on page load
	document.addEventListener('DOMContentLoaded', initNavigation);
	
	// Re-initialize after Astro page transitions
	document.addEventListener('astro:page-load', initNavigation);
</script>

<style>
	/* AI Solutions submenu hover effect */
	.ai-solutions-submenu:hover .ai-solutions-submenu-content {
		opacity: 1;
		visibility: visible;
	}
</style>
